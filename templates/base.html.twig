<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
        <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>⚫️</text><text y=%221.3em%22 x=%220.2em%22 font-size=%2276%22 fill=%22%23fff%22>sf</text></svg>">
        <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" rel="stylesheet">
        <title>{% block title %}Welcome!{% endblock %}</title>

        {% block stylesheets %}
        {% endblock %}

        {% block javascripts %}
            {% block importmap %}{{ importmap('app') }}{% endblock %}
        {% endblock %}
    </head>
    <body>
        <main class="bg-light">
            {% block body %}{% endblock %}
        </main>

        <script async src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAfyW9_DU_RWjX4i9OSUBLKNnhDLNWcHYY&callback=initMap"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
<script>
    function initMap() {

        const positionSaintMaximin = {
            lat: 49.2325935,
            lng: 2.4628570 
        };

        // map
        const mainMapElement = document.getElementById("map");
        if (mainMapElement) {
            const mainMap = new google.maps.Map(mainMapElement, {
                zoom: 14, // Zoom plus proche
                center: positionSaintMaximin
            });
            new google.maps.Marker({
                position: positionSaintMaximin, 
                map: mainMap, 
                title: "Volkswagen Bégué Saint-Maximin"
            });
        }

        // footerMap
        const footerMapElement = document.getElementById("footerMap");
        if (footerMapElement) {
            const footerMap = new google.maps.Map(footerMapElement, {
                zoom: 12, 
                center: positionSaintMaximin 
            });
        }
    }
</script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        
        const loadMoreBtn = document.getElementById('load-more-btn');
        // Récupérer TOUS les véhicules, visibles et cachés
        const vehicleCards = document.querySelectorAll('.vehicle-card');
        
        const loadAmount = 3; // Nombre de véhicules à charger à chaque clic
        
        // Déterminer combien de véhicules sont visibles initialement (3)
        // On cherche le dernier index visible, qui est 3
        let currentVisible = 3; 
        
        function loadMoreVehicles() {
            const totalVehicles = vehicleCards.length;
            const nextBatchEnd = currentVisible + loadAmount;
            
            // Afficher la prochaine série de véhicules
            for (let i = currentVisible; i < nextBatchEnd && i < totalVehicles; i++) {
                vehicleCards[i].classList.remove('d-none');
            }
            
            // Mettre à jour le compteur des véhicules visibles
            currentVisible = Math.min(nextBatchEnd, totalVehicles);
            
            // Si tous les véhicules sont affichés, masquer le bouton
            if (currentVisible >= totalVehicles) {
                loadMoreBtn.style.display = 'none';
            }
        }
        
        if (loadMoreBtn) {
            loadMoreBtn.addEventListener('click', loadMoreVehicles);
        }
    });
</script>
    </body>
</html>